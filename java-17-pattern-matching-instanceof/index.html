<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js"><!--<![endif]--><head><meta charset="UTF-8"><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Pattern Matching for instanceof (Java 17) – Thoughts To Pen</title><meta name="description" content="Simplify type checking and casting in Java 17 with Pattern Matching for instanceof, eliminating boilerplate code."><meta name="keywords" content="programming, java, java17"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://thoughtstopen.com/assets/img/logo.png"><meta name="twitter:title" content="Pattern Matching for instanceof (Java 17)"><meta name="twitter:description" content="Pattern Matching for instanceof in Java 17 combines type testing and variable binding, making your code cleaner and more readable."><meta name="twitter:site" content="@imAmanRana"><meta name="twitter:creator" content="@imAmanRana"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Pattern Matching for instanceof (Java 17)"><meta property="og:description" content="Pattern Matching for instanceof in Java 17 combines type testing and variable binding, making your code cleaner and more readable."><meta property="og:url" content="https://thoughtstopen.com/java-17-pattern-matching-instanceof/"><meta property="og:site_name" content="Thoughts To Pen"><meta property="og:image" content="https://thoughtstopen.com/assets/img/logo.png"><link rel="canonical" href="https://thoughtstopen.com/java-17-pattern-matching-instanceof/"><link href="https://thoughtstopen.com/feed.xml" type="application/atom+xml" rel="alternate" title="Thoughts To Pen Feed"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-adsense-account" content="ca-pub-6060334903166477"><link rel="stylesheet" href="https://thoughtstopen.com/assets/css/main.css"><script src="https://thoughtstopen.com/assets/js/modernizr-3.3.1.custom.min.js"></script><link rel="apple-touch-icon" href="https://thoughtstopen.com/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="72x72" href="https://thoughtstopen.com/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="114x114" href="https://thoughtstopen.com/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="144x144" href="https://thoughtstopen.com/assets/img/favicons/apple-icon-144x144.png"><link rel="shortcut icon" type="image/png" href="https://thoughtstopen.com/favicon.png"><link rel="shortcut icon" href="https://thoughtstopen.com/favicon.ico"><style type="text/css">body{background-image:url(https://thoughtstopen.com/assets/img/placeholder-big.jpg)}</style></head><body><nav id="dl-menu" class="dl-menuwrapper" role="navigation"><button class="dl-trigger">Open Menu</button><ul class="dl-menu"><li><a href="https://thoughtstopen.com/">Home</a></li><li><a href="#">About</a><ul class="dl-submenu"><li><img src="https://thoughtstopen.com/assets/img/logo.png" alt="Thoughts To Pen photo" class="author-photo"><h4>Thoughts To Pen</h4><p>My thoughts on Computer Programming || Psychology || Personal Finances || &amp; much more...</p></li><li><a href="https://thoughtstopen.com/about/"><span class="btn btn-inverse">Learn More</span></a></li><li><a href="http://twitter.com/imAmanRana" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a></li><li><a href="http://instagram.com/i.m.amanrana" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-instagram"></i> Instagram</a></li><li><a href="http://github.com/imAmanRana" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a></li><li><a href="http://stackoverflow.com/users/3932093/imamanrana" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-stack-overflow"></i> StackOverflow</a></li></ul></li><li><a href="#">Posts</a><ul class="dl-submenu"><li><a href="https://thoughtstopen.com/posts/">All Posts</a></li><li><a href="https://thoughtstopen.com/tags/">All Tags</a></li></ul></li><li><a href="https://thoughtstopen.com/projects/">Projects</a></li><li><a href="https://thoughtstopen.com/portfolio/">Portfolio</a></li><li><a href="https://thoughtstopen.com/resources/">Resources</a></li><li><a href="https://thoughtstopen.com/about/">About</a></li></ul></nav><header class="header" role="banner"><div class="wrapper animated fadeIn"><div class="content"><div class="post-title "><h1>Pattern Matching for instanceof (Java 17)</h1><h4>10 Nov 2025</h4><a class="btn zoombtn" onclick="window.history.back()"><i class="fa fa-chevron-left"></i></a></div><p>Pattern Matching for <code class="language-plaintext highlighter-rouge">instanceof</code>, finalized in Java 16 and included in Java 17 through JEP 394, revolutionizes how we perform type checks and casts in Java. This feature eliminates the redundant casting that traditionally follows an <code class="language-plaintext highlighter-rouge">instanceof</code> check, making your code more concise and less error-prone.</p><h2 id="the-old-way-vs-the-new-way">The Old Way vs. The New Way</h2><h3 id="before-java-17-traditional-approach">Before Java 17 (Traditional Approach)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>  <span class="c1">// Redundant cast</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"String length: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="with-java-17-pattern-matching">With Java 17 (Pattern Matching)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// Type test + binding in one</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"String length: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>The pattern variable <code class="language-plaintext highlighter-rouge">str</code> is automatically created and scoped to the <code class="language-plaintext highlighter-rouge">if</code> block, eliminating the need for an explicit cast.</p><h2 id="how-it-works">How It Works</h2><p>When you use pattern matching with <code class="language-plaintext highlighter-rouge">instanceof</code>, Java performs two operations simultaneously:</p><ol><li><strong>Type Test</strong>: Checks if the object is an instance of the specified type</li><li><strong>Binding</strong>: If the test succeeds, creates a new variable of that type</li></ol><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 'str' is available here and is of type String</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
<span class="o">}</span>
<span class="c1">// 'str' is NOT available here (out of scope)</span>
</code></pre></div></div><h2 id="scope-rules">Scope Rules</h2><p>The pattern variable is only in scope where the compiler can guarantee the <code class="language-plaintext highlighter-rouge">instanceof</code> check succeeded:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">demonstrateScope</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Pattern variable in if statement</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>  <span class="c1">// ✓ str is in scope</span>
    <span class="o">}</span>
    <span class="c1">// System.out.println(str.length());  // ✗ Compile error: str out of scope</span>
    
    <span class="c1">// Pattern variable with logical AND</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Long string: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">);</span>  <span class="c1">// ✓ str is in scope</span>
    <span class="o">}</span>
    
    <span class="c1">// Pattern variable with logical OR</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">||</span> <span class="n">str</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>  <span class="c1">// ✗ Compile error</span>
        <span class="c1">// str might not be initialized if first condition is false</span>
    <span class="o">}</span>
    
    <span class="c1">// Pattern variable with negation</span>
    <span class="k">if</span> <span class="o">(!(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// System.out.println(str);  // ✗ str is NOT in scope here</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>  <span class="c1">// ✓ str IS in scope here</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="real-world-example-processing-different-message-types">Real-World Example: Processing Different Message Types</h2><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">interface</span> <span class="nc">Message</span> <span class="n">permits</span> <span class="nc">TextMessage</span><span class="o">,</span> <span class="nc">ImageMessage</span><span class="o">,</span> <span class="nc">VideoMessage</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">TextMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">content</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">ImageMessage</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="nc">String</span> <span class="n">caption</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">VideoMessage</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="kt">int</span> <span class="n">duration</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MessageProcessor</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="nc">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Text from "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">sender</span><span class="o">()</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">());</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">ImageMessage</span> <span class="n">img</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Image from "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">sender</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caption: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">caption</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Size: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">data</span><span class="o">().</span><span class="na">length</span> <span class="o">+</span> <span class="s">" bytes"</span><span class="o">);</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">VideoMessage</span> <span class="n">vid</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Video from "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">sender</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Duration: "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">duration</span><span class="o">()</span> <span class="o">+</span> <span class="s">" seconds"</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Size: "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">data</span><span class="o">().</span><span class="na">length</span> <span class="o">+</span> <span class="s">" bytes"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessageSummary</span><span class="o">(</span><span class="nc">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span> <span class="o">&amp;&amp;</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">().</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Long text message from "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">sender</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Text: "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">ImageMessage</span> <span class="n">img</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Image: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">caption</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">VideoMessage</span> <span class="n">vid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Video ("</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">duration</span><span class="o">()</span> <span class="o">+</span> <span class="s">"s)"</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">"Unknown message type"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="combining-with-logical-operators">Combining with Logical Operators</h2><p>Pattern matching works seamlessly with logical operators:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">validateInput</span><span class="o">(</span><span class="nc">Object</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Using AND to add additional conditions</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">str</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Valid string: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="c1">// Using AND with multiple pattern variables</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"\\d+"</span><span class="o">))</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Parsed number: "</span> <span class="o">+</span> <span class="n">number</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="practical-example-shape-area-calculator">Practical Example: Shape Area Calculator</h2><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Circle</span><span class="o">(</span><span class="kt">double</span> <span class="n">radius</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getRadius</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">width</span><span class="o">,</span> <span class="kt">double</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getWidth</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getHeight</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShapeAnalyzer</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">analyzeShape</span><span class="o">(</span><span class="nc">Shape</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span><span class="o">.</span><span class="na">getRadius</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Large circle with area: "</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Small circle with area: "</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span> <span class="o">&amp;&amp;</span> <span class="n">r</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="na">getHeight</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Square with area: "</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Rectangle with area: "</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="s">"Unknown shape"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculatePerimeter</span><span class="o">(</span><span class="nc">Shape</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="na">getRadius</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getHeight</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="benefits">Benefits</h2><h3 id="1-reduced-boilerplate">1. <strong>Reduced Boilerplate</strong></h3><p>No more redundant casting after <code class="language-plaintext highlighter-rouge">instanceof</code> checks.</p><h3 id="2-improved-readability">2. <strong>Improved Readability</strong></h3><p>The intent is clearer when the type test and binding happen together.</p><h3 id="3-fewer-errors">3. <strong>Fewer Errors</strong></h3><p>Eliminates the possibility of casting to the wrong type after an <code class="language-plaintext highlighter-rouge">instanceof</code> check.</p><h3 id="4-better-performance">4. <strong>Better Performance</strong></h3><p>The JVM only performs the type check once, not twice (once for <code class="language-plaintext highlighter-rouge">instanceof</code> and once for the cast).</p><h2 id="common-patterns">Common Patterns</h2><h3 id="null-safe-processing">Null-Safe Processing</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">int</span> <span class="nf">getStringLength</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>  <span class="c1">// null or not a String</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="nested-conditions">Nested Conditions</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processData</span><span class="o">(</span><span class="nc">Object</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">data</span> <span class="k">instanceof</span> <span class="nc">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">firstStr</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"First element: "</span> <span class="o">+</span> <span class="n">firstStr</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="early-returns">Early Returns</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">formatValue</span><span class="o">(</span><span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(!(</span><span class="n">value</span> <span class="k">instanceof</span> <span class="nc">Number</span> <span class="n">num</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Not a number"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// num is in scope for the rest of the method</span>
    <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%.2f"</span><span class="o">,</span> <span class="n">num</span><span class="o">.</span><span class="na">doubleValue</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>Pattern Matching for <code class="language-plaintext highlighter-rouge">instanceof</code> is a simple yet powerful feature that makes Java code more concise and readable. By combining type testing with variable binding, it eliminates redundant casts and reduces the potential for errors. This feature works particularly well with sealed classes and modern Java patterns, making your code both safer and more expressive.</p><div class="entry-meta"><br><hr><span class="entry-tags"><a href="https://thoughtstopen.com/tags/#programming" title="Pages tagged programming" class="tag"><span class="term">programming</span></a><a href="https://thoughtstopen.com/tags/#java" title="Pages tagged java" class="tag"><span class="term">java</span></a><a href="https://thoughtstopen.com/tags/#java17" title="Pages tagged java17" class="tag"><span class="term">java17</span></a></span><span class="social-share"><a href="https://www.facebook.com/sharer/sharer.php?u=https://thoughtstopen.com/java-17-pattern-matching-instanceof/" target="_blank" title="Share on Facebook" class="tag"><span class="term"><i class="fa fa-facebook-square"></i> Share</span></a><a href="https://twitter.com/intent/tweet?text=https://thoughtstopen.com/java-17-pattern-matching-instanceof/" target="_blank" title="Share on Twitter" class="tag"><span class="term"><i class="fa fa-twitter-square"></i> Tweet</span></a><a href="https://api.whatsapp.com/send?text=https://thoughtstopen.com/java-17-pattern-matching-instanceof/" target="_blank" title="Share on Whatsapp" class="tag"><span class="term"><i class="fa fa-whatsapp"></i> Msg</span></a></span><div style="clear:both"></div></div></div></div></header><script src="https://thoughtstopen.com/assets/js/jquery-1.12.0.min.js"></script><script src="https://thoughtstopen.com/assets/js/jquery.dlmenu.min.js"></script><script src="https://thoughtstopen.com/assets/js/jquery.goup.min.js"></script><script src="https://thoughtstopen.com/assets/js/jquery.magnific-popup.min.js"></script><script src="https://thoughtstopen.com/assets/js/jquery.fitvid.min.js"></script><script src="https://thoughtstopen.com/assets/js/scripts.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-KR4P1CKKT4"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KR4P1CKKT4");</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-60603349031664777" crossorigin="anonymous"></script><script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>