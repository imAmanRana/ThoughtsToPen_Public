<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="https://thoughtstopen.com/feed.xml" rel="self" type="application/atom+xml"/><link href="https://thoughtstopen.com/" rel="alternate" type="text/html"/><updated>2026-01-08T23:30:01-07:00</updated><id>https://thoughtstopen.com/feed.xml</id><title type="html">Thoughts To Pen</title><subtitle>My thoughts on Computer Programming || Psychology || Personal Finances || &amp; much more...</subtitle><entry><title type="html">Enhanced Pseudo-Random Number Generators (Java 17)</title><link href="https://thoughtstopen.com/java-17-random-generators/" rel="alternate" type="text/html" title="Enhanced Pseudo-Random Number Generators (Java 17)"/><published>2025-11-25T09:00:00-07:00</published><updated>2025-11-25T09:00:00-07:00</updated><id>https://thoughtstopen.com/java-17-random-generators</id><content type="html" xml:base="https://thoughtstopen.com/java-17-random-generators/"><![CDATA[<p>Java 17 introduces Enhanced Pseudo-Random Number Generators through JEP 356, providing a modern, flexible framework for generating random numbers. This update brings new interfaces, multiple algorithm implementations, and better support for stream-based operations, addressing limitations of the legacy <code class="language-plaintext highlighter-rouge">java.util.Random</code> class.</p><h2 id="the-problem-with-legacy-random">The Problem with Legacy Random</h2><p>The traditional <code class="language-plaintext highlighter-rouge">java.util.Random</code> class has several limitations:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>  <span class="c1">// Limited to one algorithm</span>
</code></pre></div></div><p><strong>Issues:</strong></p><ul><li>Only one algorithm (Linear Congruential Generator)</li><li>No easy way to switch algorithms</li><li>Limited support for modern use cases</li><li>Not designed for streams and parallel processing</li></ul><h2 id="the-new-framework">The New Framework</h2><p>Java 17 introduces a hierarchy of interfaces and implementations:</p><h3 id="core-interfaces">Core Interfaces</h3><ol><li><strong><code class="language-plaintext highlighter-rouge">RandomGenerator</code></strong> - Base interface for all generators</li><li><strong><code class="language-plaintext highlighter-rouge">RandomGenerator.SplittableGenerator</code></strong> - For parallel streams</li><li><strong><code class="language-plaintext highlighter-rouge">RandomGenerator.JumpableGenerator</code></strong> - For jumping ahead in sequence</li><li><strong><code class="language-plaintext highlighter-rouge">RandomGenerator.LeapableGenerator</code></strong> - For large jumps</li><li><strong><code class="language-plaintext highlighter-rouge">RandomGenerator.ArbitrarilyJumpableGenerator</code></strong> - For arbitrary jumps</li></ol><h3 id="new-factory-method">New Factory Method</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
</code></pre></div></div><h2 id="available-algorithms">Available Algorithms</h2><p>Java 17 provides multiple high-quality PRNG algorithms:</p><table><thead><tr><th>Algorithm</th><th>Best For</th><th>Thread-Safe</th></tr></thead><tbody><tr><td><code class="language-plaintext highlighter-rouge">L32X64MixRandom</code></td><td>General purpose, small state</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L64X128MixRandom</code></td><td>General purpose, medium state</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L64X256MixRandom</code></td><td>High-quality randomness</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L64X1024MixRandom</code></td><td>Highest quality, large state</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L128X128MixRandom</code></td><td>Very high quality</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L128X256MixRandom</code></td><td>Excellent quality</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">L128X1024MixRandom</code></td><td>Best quality, largest state</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">Xoroshiro128PlusPlus</code></td><td>Fast, good quality</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">Xoshiro256PlusPlus</code></td><td>Fast, better quality</td><td>No</td></tr><tr><td><code class="language-plaintext highlighter-rouge">Random</code></td><td>Legacy compatibility</td><td>Yes</td></tr><tr><td><code class="language-plaintext highlighter-rouge">SecureRandom</code></td><td>Cryptographic security</td><td>Yes</td></tr></tbody></table><h2 id="basic-usage">Basic Usage</h2><h3 id="creating-generators">Creating Generators</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Using factory method with algorithm name</span>
<span class="nc">RandomGenerator</span> <span class="n">rng1</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>

<span class="c1">// Using default algorithm</span>
<span class="nc">RandomGenerator</span> <span class="n">rng2</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">getDefault</span><span class="o">();</span>

<span class="c1">// Using specific implementation class</span>
<span class="nc">RandomGenerator</span> <span class="n">rng3</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Xoshiro256PlusPlus</span><span class="o">();</span>

<span class="c1">// Legacy Random still works</span>
<span class="nc">Random</span> <span class="n">legacyRandom</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>
</code></pre></div></div><h3 id="generating-random-values">Generating Random Values</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>

<span class="c1">// Integers</span>
<span class="kt">int</span> <span class="n">randomInt</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">boundedInt</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>  <span class="c1">// 0 to 99</span>
<span class="kt">int</span> <span class="n">rangedInt</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span> <span class="c1">// 10 to 19</span>

<span class="c1">// Longs</span>
<span class="kt">long</span> <span class="n">randomLong</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextLong</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">boundedLong</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextLong</span><span class="o">(</span><span class="mi">1000L</span><span class="o">);</span>

<span class="c1">// Doubles</span>
<span class="kt">double</span> <span class="n">randomDouble</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">();</span>  <span class="c1">// 0.0 to 1.0</span>
<span class="kt">double</span> <span class="n">rangedDouble</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">(</span><span class="mf">10.0</span><span class="o">,</span> <span class="mf">20.0</span><span class="o">);</span>

<span class="c1">// Booleans</span>
<span class="kt">boolean</span> <span class="n">randomBoolean</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextBoolean</span><span class="o">();</span>

<span class="c1">// Bytes</span>
<span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
<span class="n">rng</span><span class="o">.</span><span class="na">nextBytes</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
</code></pre></div></div><h2 id="stream-based-operations">Stream-Based Operations</h2><p>One of the most powerful features is stream support:</p><h3 id="infinite-streams">Infinite Streams</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>

<span class="c1">// Stream of random integers</span>
<span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">()</span>
   <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
   <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>

<span class="c1">// Stream of bounded integers</span>
<span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>  <span class="c1">// limit to 100 values</span>
   <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
   <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>

<span class="c1">// Stream with range</span>
<span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>  <span class="c1">// 10 values between 1 and 99</span>
   <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div></div><h3 id="practical-stream-examples">Practical Stream Examples</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Generate random passwords</span>
<span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">127</span><span class="o">)</span>  <span class="c1">// 12 printable ASCII characters</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nl">StringBuilder:</span><span class="o">:</span><span class="k">new</span><span class="o">,</span>
             <span class="nl">StringBuilder:</span><span class="o">:</span><span class="n">appendCodePoint</span><span class="o">,</span>
             <span class="nl">StringBuilder:</span><span class="o">:</span><span class="n">append</span><span class="o">)</span>
    <span class="o">.</span><span class="na">toString</span><span class="o">();</span>

<span class="c1">// Generate test data</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">testScores</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">101</span><span class="o">)</span>  <span class="c1">// 100 scores from 0 to 100</span>
    <span class="o">.</span><span class="na">boxed</span><span class="o">()</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

<span class="c1">// Simulate dice rolls</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="n">diceRolls</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">10000</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">7</span><span class="o">)</span>  <span class="c1">// 10,000 rolls of a 6-sided die</span>
    <span class="o">.</span><span class="na">boxed</span><span class="o">()</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">groupingBy</span><span class="o">(</span>
        <span class="nc">Function</span><span class="o">.</span><span class="na">identity</span><span class="o">(),</span>
        <span class="nc">Collectors</span><span class="o">.</span><span class="na">counting</span><span class="o">()</span>
    <span class="o">));</span>
</code></pre></div></div><h2 id="splittable-generators-for-parallel-processing">Splittable Generators for Parallel Processing</h2><p>For parallel streams, use splittable generators:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">SplittableGenerator</span> <span class="n">splitRng</span> <span class="o">=</span> 
    <span class="nc">RandomGeneratorFactory</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>

<span class="c1">// Parallel stream with independent generators</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;</span> <span class="n">parallelRandoms</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1000000</span><span class="o">)</span>
    <span class="o">.</span><span class="na">parallel</span><span class="o">()</span>
    <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">splitRng</span><span class="o">.</span><span class="na">split</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">())</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
</code></pre></div></div><h2 id="real-world-examples">Real-World Examples</h2><h3 id="1-monte-carlo-simulation">1. Monte Carlo Simulation</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MonteCarloSimulation</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">estimatePi</span><span class="o">(</span><span class="kt">int</span> <span class="n">iterations</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
        
        <span class="kt">long</span> <span class="n">insideCircle</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">doubles</span><span class="o">(</span><span class="n">iterations</span><span class="o">)</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]{</span><span class="n">x</span><span class="o">,</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">()})</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">point</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="n">point</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
                <span class="kt">double</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
                <span class="k">return</span> <span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="o">;</span>
            <span class="o">})</span>
            <span class="o">.</span><span class="na">count</span><span class="o">();</span>
        
        <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">insideCircle</span> <span class="o">/</span> <span class="n">iterations</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">estimatePi</span><span class="o">(</span><span class="mi">1_000_000</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Estimated π: "</span> <span class="o">+</span> <span class="n">pi</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Actual π: "</span> <span class="o">+</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Error: "</span> <span class="o">+</span> <span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">pi</span> <span class="o">-</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="2-random-data-generator">2. Random Data Generator</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDataGenerator</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RandomGenerator</span> <span class="n">rng</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">TestDataGenerator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">randomEmail</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="sc">'a'</span><span class="o">,</span> <span class="sc">'z'</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nl">StringBuilder:</span><span class="o">:</span><span class="k">new</span><span class="o">,</span>
                     <span class="nl">StringBuilder:</span><span class="o">:</span><span class="n">appendCodePoint</span><span class="o">,</span>
                     <span class="nl">StringBuilder:</span><span class="o">:</span><span class="n">append</span><span class="o">)</span>
            <span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">username</span> <span class="o">+</span> <span class="s">"@example.com"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">randomPhoneNumber</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"(%03d) %03d-%04d"</span><span class="o">,</span>
            <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">1000</span><span class="o">),</span>
            <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">1000</span><span class="o">),</span>
            <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">10000</span><span class="o">)</span>
        <span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">LocalDate</span> <span class="nf">randomBirthdate</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">minDay</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1950</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">toEpochDay</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">maxDay</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">2005</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">31</span><span class="o">).</span><span class="na">toEpochDay</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">randomDay</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextLong</span><span class="o">(</span><span class="n">minDay</span><span class="o">,</span> <span class="n">maxDay</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="k">return</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">ofEpochDay</span><span class="o">(</span><span class="n">randomDay</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">randomNames</span><span class="o">(</span><span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">firstNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"Alice"</span><span class="o">,</span> <span class="s">"Bob"</span><span class="o">,</span> <span class="s">"Charlie"</span><span class="o">,</span> <span class="s">"Diana"</span><span class="o">,</span> <span class="s">"Eve"</span><span class="o">};</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">lastNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"Smith"</span><span class="o">,</span> <span class="s">"Johnson"</span><span class="o">,</span> <span class="s">"Williams"</span><span class="o">,</span> <span class="s">"Brown"</span><span class="o">,</span> <span class="s">"Jones"</span><span class="o">};</span>
        
        <span class="k">return</span> <span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="n">count</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">firstNames</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">firstNames</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> 
                          <span class="n">lastNames</span><span class="o">[</span><span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">lastNames</span><span class="o">.</span><span class="na">length</span><span class="o">)])</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="3-weighted-random-selection">3. Weighted Random Selection</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeightedRandomSelector</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;</span> <span class="n">cumulativeWeights</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RandomGenerator</span> <span class="n">rng</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">WeightedRandomSelector</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="no">T</span><span class="o">,</span> <span class="nc">Double</span><span class="o">&gt;</span> <span class="n">weightedItems</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">items</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">weightedItems</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cumulativeWeights</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        
        <span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="no">T</span> <span class="n">item</span> <span class="o">:</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">weightedItems</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
            <span class="n">cumulativeWeights</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">sum</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="no">T</span> <span class="nf">select</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">random</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">()</span> <span class="o">*</span> <span class="n">cumulativeWeights</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">cumulativeWeights</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cumulativeWeights</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">random</span> <span class="o">&lt;=</span> <span class="n">cumulativeWeights</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">selectMultiple</span><span class="o">(</span><span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">count</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">select</span><span class="o">())</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Usage</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Double</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="nc">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
    <span class="s">"Common"</span><span class="o">,</span> <span class="mf">50.0</span><span class="o">,</span>
    <span class="s">"Uncommon"</span><span class="o">,</span> <span class="mf">30.0</span><span class="o">,</span>
    <span class="s">"Rare"</span><span class="o">,</span> <span class="mf">15.0</span><span class="o">,</span>
    <span class="s">"Epic"</span><span class="o">,</span> <span class="mf">4.0</span><span class="o">,</span>
    <span class="s">"Legendary"</span><span class="o">,</span> <span class="mf">1.0</span>
<span class="o">);</span>

<span class="nc">WeightedRandomSelector</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">selector</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WeightedRandomSelector</span><span class="o">&lt;&gt;(</span><span class="n">items</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">drops</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="na">selectMultiple</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
</code></pre></div></div><h3 id="4-shuffling-collections">4. Shuffling Collections</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CollectionShuffler</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">shuffle</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="nc">RandomGenerator</span> <span class="n">rng</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
            <span class="nc">Collections</span><span class="o">.</span><span class="na">swap</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">deck</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">suit</span> <span class="o">:</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"♠"</span><span class="o">,</span> <span class="s">"♥"</span><span class="o">,</span> <span class="s">"♦"</span><span class="o">,</span> <span class="s">"♣"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">rank</span> <span class="o">:</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">,</span> <span class="s">"4"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">,</span> <span class="s">"6"</span><span class="o">,</span> 
                                      <span class="s">"7"</span><span class="o">,</span> <span class="s">"8"</span><span class="o">,</span> <span class="s">"9"</span><span class="o">,</span> <span class="s">"10"</span><span class="o">,</span> <span class="s">"J"</span><span class="o">,</span> <span class="s">"Q"</span><span class="o">,</span> <span class="s">"K"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">deck</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rank</span> <span class="o">+</span> <span class="n">suit</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        
        <span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
        <span class="n">shuffle</span><span class="o">(</span><span class="n">deck</span><span class="o">,</span> <span class="n">rng</span><span class="o">);</span>
        
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Shuffled deck: "</span> <span class="o">+</span> <span class="n">deck</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="choosing-the-right-algorithm">Choosing the Right Algorithm</h2><h3 id="for-general-use">For General Use</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
</code></pre></div></div><h3 id="for-high-quality-randomness">For High-Quality Randomness</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L128X256MixRandom"</span><span class="o">);</span>
</code></pre></div></div><h3 id="for-speed">For Speed</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Xoshiro256PlusPlus"</span><span class="o">);</span>
</code></pre></div></div><h3 id="for-cryptographic-security">For Cryptographic Security</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecureRandom</span><span class="o">();</span>
</code></pre></div></div><h2 id="best-practices">Best Practices</h2><h3 id="1-reuse-generator-instances">1. <strong>Reuse Generator Instances</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - reuse the generator</span>
<span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// Bad - creating new generators is expensive</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="2-use-streams-for-bulk-generation">2. <strong>Use Streams for Bulk Generation</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - efficient stream-based generation</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">1000</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
    <span class="o">.</span><span class="na">boxed</span><span class="o">()</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

<span class="c1">// Less efficient - loop-based generation</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">numbers2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">numbers2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rng</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">100</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="3-choose-appropriate-algorithm">3. <strong>Choose Appropriate Algorithm</strong></h3><p>Don’t use <code class="language-plaintext highlighter-rouge">SecureRandom</code> for non-security purposes - it’s much slower.</p><h2 id="conclusion">Conclusion</h2><p>Java 17’s Enhanced Pseudo-Random Number Generators provide a modern, flexible framework for generating random numbers. With multiple high-quality algorithms, excellent stream support, and better parallel processing capabilities, this feature addresses the limitations of legacy <code class="language-plaintext highlighter-rouge">Random</code> while maintaining backward compatibility. Whether you’re building simulations, generating test data, or implementing game mechanics, the new PRNG framework offers the tools you need for high-quality randomness.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Explore Java 17's new random number generator interfaces and algorithms for better performance and flexibility.]]></summary></entry><entry><title type="html">Records (Java 17)</title><link href="https://thoughtstopen.com/java-17-records/" rel="alternate" type="text/html" title="Records (Java 17)"/><published>2025-11-20T09:00:00-07:00</published><updated>2025-11-20T09:00:00-07:00</updated><id>https://thoughtstopen.com/java-17-records</id><content type="html" xml:base="https://thoughtstopen.com/java-17-records/"><![CDATA[<p>Records, finalized in Java 16 and available in Java 17 through JEP 395, are a revolutionary feature for creating immutable data carrier classes. They eliminate the boilerplate code traditionally required for simple data classes, making your code cleaner, more maintainable, and less error-prone.</p><h2 id="the-problem-boilerplate-overload">The Problem: Boilerplate Overload</h2><p>Before records, creating a simple data class required extensive boilerplate:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">age</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getEmail</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">obj</span><span class="o">)</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(!(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">Person</span><span class="o">))</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="nc">Person</span> <span class="n">other</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Person</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">age</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="na">age</span> <span class="o">&amp;&amp;</span>
               <span class="nc">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">other</span><span class="o">.</span><span class="na">name</span><span class="o">)</span> <span class="o">&amp;&amp;</span>
               <span class="nc">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">email</span><span class="o">,</span> <span class="n">other</span><span class="o">.</span><span class="na">email</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">hash</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">age</span><span class="o">,</span> <span class="n">email</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Person[name="</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">", age="</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="s">", email="</span> <span class="o">+</span> <span class="n">email</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>That’s over 40 lines of code for a simple data class!</p><h2 id="the-solution-records">The Solution: Records</h2><p>With records, the same class becomes:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{}</span>
</code></pre></div></div><p>Just one line! The compiler automatically generates:</p><ul><li>A canonical constructor</li><li>Accessor methods (<code class="language-plaintext highlighter-rouge">name()</code>, <code class="language-plaintext highlighter-rouge">age()</code>, <code class="language-plaintext highlighter-rouge">email()</code>)</li><li><code class="language-plaintext highlighter-rouge">equals()</code> and <code class="language-plaintext highlighter-rouge">hashCode()</code> methods</li><li>A <code class="language-plaintext highlighter-rouge">toString()</code> method</li></ul><h2 id="how-records-work">How Records Work</h2><h3 id="basic-syntax">Basic Syntax</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Point</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{}</span>

<span class="c1">// Usage</span>
<span class="nc">Point</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">x</span><span class="o">());</span>  <span class="c1">// 10</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">y</span><span class="o">());</span>  <span class="c1">// 20</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>      <span class="c1">// Point[x=10, y=20]</span>
</code></pre></div></div><h3 id="key-characteristics">Key Characteristics</h3><ol><li><strong>Immutable</strong>: All fields are <code class="language-plaintext highlighter-rouge">final</code> by default</li><li><strong>Implicitly Final</strong>: Records cannot be extended</li><li><strong>Accessor Methods</strong>: Named after the field (not <code class="language-plaintext highlighter-rouge">getX()</code>, but <code class="language-plaintext highlighter-rouge">x()</code>)</li><li><strong>Value-Based</strong>: Equality based on field values, not identity</li></ol><h2 id="custom-constructors">Custom Constructors</h2><h3 id="compact-constructor">Compact Constructor</h3><p>Add validation or normalization without repeating parameters:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Email</span><span class="o">(</span><span class="nc">String</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Email</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">address</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">address</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"@"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Invalid email address"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Normalize to lowercase</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Usage</span>
<span class="nc">Email</span> <span class="n">email</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Email</span><span class="o">(</span><span class="s">"USER@EXAMPLE.COM"</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">email</span><span class="o">.</span><span class="na">address</span><span class="o">());</span>  <span class="c1">// user@example.com</span>
</code></pre></div></div><h3 id="canonical-constructor">Canonical Constructor</h3><p>Override the full constructor when needed:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Range</span><span class="o">(</span><span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Range</span><span class="o">(</span><span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Start must be &lt;= end"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="alternative-constructors">Alternative Constructors</h3><p>Add convenience constructors:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Compact constructor for validation</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Age cannot be negative"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// Alternative constructor with default email</span>
    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">age</span><span class="o">,</span> <span class="s">"no-email@example.com"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="adding-custom-methods">Adding Custom Methods</h2><p>Records can have instance and static methods:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">width</span><span class="o">,</span> <span class="kt">double</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">perimeter</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">height</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSquare</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span> <span class="o">==</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Rectangle</span> <span class="nf">square</span><span class="o">(</span><span class="kt">double</span> <span class="n">side</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="n">side</span><span class="o">,</span> <span class="n">side</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Usage</span>
<span class="nc">Rectangle</span> <span class="n">rect</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Rectangle</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Area: "</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="na">area</span><span class="o">());</span>           <span class="c1">// 200.0</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Perimeter: "</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="na">perimeter</span><span class="o">());</span> <span class="c1">// 60.0</span>

<span class="nc">Rectangle</span> <span class="n">sq</span> <span class="o">=</span> <span class="nc">Rectangle</span><span class="o">.</span><span class="na">square</span><span class="o">(</span><span class="mi">15</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Is square: "</span> <span class="o">+</span> <span class="n">sq</span><span class="o">.</span><span class="na">isSquare</span><span class="o">());</span>    <span class="c1">// true</span>
</code></pre></div></div><h2 id="real-world-examples">Real-World Examples</h2><h3 id="1-data-transfer-objects-dtos">1. Data Transfer Objects (DTOs)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">UserDTO</span><span class="o">(</span>
    <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">username</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">email</span><span class="o">,</span>
    <span class="nc">LocalDateTime</span> <span class="n">createdAt</span><span class="o">,</span>
    <span class="kt">boolean</span> <span class="n">active</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">UserDTO</span> <span class="nf">fromEntity</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UserDTO</span><span class="o">(</span>
            <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span>
            <span class="n">user</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span>
            <span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span>
            <span class="n">user</span><span class="o">.</span><span class="na">getCreatedAt</span><span class="o">(),</span>
            <span class="n">user</span><span class="o">.</span><span class="na">isActive</span><span class="o">()</span>
        <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">CreateUserRequest</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">CreateUserRequest</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">username</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">username</span><span class="o">.</span><span class="na">isBlank</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Username is required"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">email</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">email</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"^[A-Za-z0-9+_.-]+@(.+)$"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Valid email is required"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">password</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Password must be at least 8 characters"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="2-configuration-classes">2. Configuration Classes</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">DatabaseConfig</span><span class="o">(</span>
    <span class="nc">String</span> <span class="n">host</span><span class="o">,</span>
    <span class="kt">int</span> <span class="n">port</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">database</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">username</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">password</span><span class="o">,</span>
    <span class="kt">int</span> <span class="n">maxConnections</span><span class="o">,</span>
    <span class="kt">int</span> <span class="n">connectionTimeout</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">DatabaseConfig</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">port</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">port</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Invalid port number"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">maxConnections</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Max connections must be positive"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// Default configuration</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">DatabaseConfig</span> <span class="nf">defaults</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DatabaseConfig</span><span class="o">(</span>
            <span class="s">"localhost"</span><span class="o">,</span>
            <span class="mi">5432</span><span class="o">,</span>
            <span class="s">"myapp"</span><span class="o">,</span>
            <span class="s">"user"</span><span class="o">,</span>
            <span class="s">"password"</span><span class="o">,</span>
            <span class="mi">10</span><span class="o">,</span>
            <span class="mi">30000</span>
        <span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">jdbcUrl</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"jdbc:postgresql://%s:%d/%s"</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">,</span> <span class="n">database</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="3-api-responses">3. API Responses</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;(</span>
    <span class="kt">boolean</span> <span class="n">success</span><span class="o">,</span>
    <span class="no">T</span> <span class="n">data</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">message</span><span class="o">,</span>
    <span class="nc">LocalDateTime</span> <span class="n">timestamp</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">success</span><span class="o">(</span><span class="no">T</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ApiResponse</span><span class="o">&lt;&gt;(</span><span class="kc">true</span><span class="o">,</span> <span class="n">data</span><span class="o">,</span> <span class="s">"Success"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">error</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ApiResponse</span><span class="o">&lt;&gt;(</span><span class="kc">false</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">message</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Usage</span>
<span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="nc">ApiResponse</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="nc">ApiResponse</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="n">errorResponse</span> <span class="o">=</span> <span class="nc">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"User not found"</span><span class="o">);</span>
</code></pre></div></div><h3 id="4-value-objects">4. Value Objects</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Money</span><span class="o">(</span><span class="nc">BigDecimal</span> <span class="n">amount</span><span class="o">,</span> <span class="nc">Currency</span> <span class="n">currency</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Money</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">amount</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">amount</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">ZERO</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Amount must be non-negative"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">currency</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Currency is required"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Money</span> <span class="nf">add</span><span class="o">(</span><span class="nc">Money</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(!</span><span class="k">this</span><span class="o">.</span><span class="na">currency</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">currency</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Cannot add different currencies"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Money</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">amount</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">amount</span><span class="o">),</span> <span class="k">this</span><span class="o">.</span><span class="na">currency</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Money</span> <span class="nf">multiply</span><span class="o">(</span><span class="nc">BigDecimal</span> <span class="n">factor</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Money</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">amount</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="n">factor</span><span class="o">),</span> <span class="k">this</span><span class="o">.</span><span class="na">currency</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Money</span> <span class="nf">usd</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Money</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">amount</span><span class="o">),</span> <span class="nc">Currency</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"USD"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Usage</span>
<span class="nc">Money</span> <span class="n">price</span> <span class="o">=</span> <span class="nc">Money</span><span class="o">.</span><span class="na">usd</span><span class="o">(</span><span class="mf">99.99</span><span class="o">);</span>
<span class="nc">Money</span> <span class="n">tax</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="nc">BigDecimal</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mf">0.08</span><span class="o">));</span>
<span class="nc">Money</span> <span class="n">total</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">tax</span><span class="o">);</span>
</code></pre></div></div><h3 id="5-coordinates-and-geometric-types">5. Coordinates and Geometric Types</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Coordinate</span><span class="o">(</span><span class="kt">double</span> <span class="n">latitude</span><span class="o">,</span> <span class="kt">double</span> <span class="n">longitude</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Coordinate</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">latitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span> <span class="o">||</span> <span class="n">latitude</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Latitude must be between -90 and 90"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">longitude</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span> <span class="o">||</span> <span class="n">longitude</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Longitude must be between -180 and 180"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">distanceTo</span><span class="o">(</span><span class="nc">Coordinate</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Haversine formula</span>
        <span class="kt">double</span> <span class="no">R</span> <span class="o">=</span> <span class="mi">6371</span><span class="o">;</span> <span class="c1">// Earth's radius in km</span>
        <span class="kt">double</span> <span class="n">dLat</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">toRadians</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">latitude</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">latitude</span><span class="o">);</span>
        <span class="kt">double</span> <span class="n">dLon</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">toRadians</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">longitude</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">longitude</span><span class="o">);</span>
        
        <span class="kt">double</span> <span class="n">a</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sin</span><span class="o">(</span><span class="n">dLat</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sin</span><span class="o">(</span><span class="n">dLat</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span> <span class="o">+</span>
                   <span class="nc">Math</span><span class="o">.</span><span class="na">cos</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">toRadians</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">latitude</span><span class="o">))</span> <span class="o">*</span>
                   <span class="nc">Math</span><span class="o">.</span><span class="na">cos</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">toRadians</span><span class="o">(</span><span class="n">other</span><span class="o">.</span><span class="na">latitude</span><span class="o">))</span> <span class="o">*</span>
                   <span class="nc">Math</span><span class="o">.</span><span class="na">sin</span><span class="o">(</span><span class="n">dLon</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sin</span><span class="o">(</span><span class="n">dLon</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
        
        <span class="kt">double</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">atan2</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">),</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">));</span>
        <span class="k">return</span> <span class="no">R</span> <span class="o">*</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="records-with-interfaces">Records with Interfaces</h2><p>Records can implement interfaces:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Identifiable</span> <span class="o">{</span>
    <span class="nc">Long</span> <span class="nf">id</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">Product</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">BigDecimal</span> <span class="n">price</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Identifiable</span> <span class="o">{</span>
    <span class="c1">// id() method is automatically provided</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">Customer</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Identifiable</span> <span class="o">{</span>
    <span class="c1">// id() method is automatically provided</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="records-in-collections">Records in Collections</h2><p>Records work perfectly with collections due to proper <code class="language-plaintext highlighter-rouge">equals()</code> and <code class="language-plaintext highlighter-rouge">hashCode()</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;</span> <span class="n">people</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;();</span>
<span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Alice"</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="s">"alice@example.com"</span><span class="o">));</span>
<span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="s">"bob@example.com"</span><span class="o">));</span>
<span class="n">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Alice"</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="s">"alice@example.com"</span><span class="o">));</span> <span class="c1">// Duplicate, won't be added</span>

<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">roles</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Alice"</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="s">"alice@example.com"</span><span class="o">),</span> <span class="s">"Admin"</span><span class="o">);</span>
<span class="n">roles</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="s">"bob@example.com"</span><span class="o">),</span> <span class="s">"User"</span><span class="o">);</span>
</code></pre></div></div><h2 id="best-practices">Best Practices</h2><h3 id="1-use-for-data-carriers-only">1. <strong>Use for Data Carriers Only</strong></h3><p>Records are perfect for DTOs, value objects, and configuration classes, but not for entities with complex behavior.</p><h3 id="2-keep-them-simple">2. <strong>Keep Them Simple</strong></h3><p>If you find yourself adding too many methods, consider whether a regular class would be better.</p><h3 id="3-validate-in-compact-constructor">3. <strong>Validate in Compact Constructor</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">Age</span><span class="o">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Age</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Invalid age"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="4-use-static-factory-methods">4. <strong>Use Static Factory Methods</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">record</span> <span class="nf">User</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">User</span> <span class="nf">guest</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">User</span><span class="o">(</span><span class="s">"Guest"</span><span class="o">,</span> <span class="s">"guest@example.com"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>Records are a powerful addition to Java that dramatically reduce boilerplate for data classes. They promote immutability, provide sensible defaults for common methods, and make code more readable and maintainable. Whether you’re building DTOs, value objects, or configuration classes, records offer a clean, concise solution that feels natural in modern Java development.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Eliminate boilerplate with Records in Java 17 - the perfect solution for immutable data carrier classes.]]></summary></entry><entry><title type="html">Text Blocks (Java 17)</title><link href="https://thoughtstopen.com/java-17-text-blocks/" rel="alternate" type="text/html" title="Text Blocks (Java 17)"/><published>2025-11-15T09:00:00-07:00</published><updated>2025-11-15T09:00:00-07:00</updated><id>https://thoughtstopen.com/java-17-text-blocks</id><content type="html" xml:base="https://thoughtstopen.com/java-17-text-blocks/"><![CDATA[<p>Text Blocks, finalized in Java 15 and available in Java 17 through JEP 378, revolutionize how we work with multi-line strings in Java. Using triple-double quotes (<code class="language-plaintext highlighter-rouge">"""</code>), text blocks make it easy to write readable, maintainable strings for JSON, SQL, HTML, XML, and other multi-line content.</p><h2 id="the-problem-with-traditional-strings">The Problem with Traditional Strings</h2><p>Before text blocks, multi-line strings required extensive use of escape sequences and concatenation:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">"{\n"</span> <span class="o">+</span>
              <span class="s">"  \"name\": \"John Doe\",\n"</span> <span class="o">+</span>
              <span class="s">"  \"age\": 30,\n"</span> <span class="o">+</span>
              <span class="s">"  \"email\": \"john@example.com\"\n"</span> <span class="o">+</span>
              <span class="s">"}"</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT users.name, users.email, orders.total\n"</span> <span class="o">+</span>
             <span class="s">"FROM users\n"</span> <span class="o">+</span>
             <span class="s">"JOIN orders ON users.id = orders.user_id\n"</span> <span class="o">+</span>
             <span class="s">"WHERE orders.status = 'completed'\n"</span> <span class="o">+</span>
             <span class="s">"ORDER BY orders.total DESC"</span><span class="o">;</span>
</code></pre></div></div><p>This approach is:</p><ul><li><strong>Hard to read</strong>: Escape sequences clutter the code</li><li><strong>Error-prone</strong>: Easy to forget <code class="language-plaintext highlighter-rouge">\n</code> or closing quotes</li><li><strong>Difficult to maintain</strong>: Formatting changes require updating multiple lines</li></ul><h2 id="text-blocks-to-the-rescue">Text Blocks to the Rescue</h2><p>Text blocks use triple-double quotes and preserve formatting automatically:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">"""
    {
      "</span><span class="n">name</span><span class="s">": "</span><span class="nc">John</span> <span class="nc">Doe</span><span class="s">",
      "</span><span class="n">age</span><span class="s">": 30,
      "</span><span class="n">email</span><span class="s">": "</span><span class="n">john</span><span class="nd">@example</span><span class="o">.</span><span class="na">com</span><span class="s">"
    }
    """</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"""
    SELECT users.name, users.email, orders.total
    FROM users
    JOIN orders ON users.id = orders.user_id
    WHERE orders.status = 'completed'
    ORDER BY orders.total DESC
    """</span><span class="o">;</span>
</code></pre></div></div><p>Much cleaner and more readable!</p><h2 id="how-text-blocks-work">How Text Blocks Work</h2><h3 id="basic-syntax">Basic Syntax</h3><p>A text block starts with <code class="language-plaintext highlighter-rouge">"""</code> followed by a line terminator, and ends with <code class="language-plaintext highlighter-rouge">"""</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">greeting</span> <span class="o">=</span> <span class="s">"""
    Hello,
    World!
    """</span><span class="o">;</span>
</code></pre></div></div><p><strong>Important</strong>: The opening <code class="language-plaintext highlighter-rouge">"""</code> must be followed by a line terminator. This is invalid:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">invalid</span> <span class="o">=</span> <span class="s">"""Hello"""</span><span class="o">;</span>  <span class="c1">// ✗ Compile error</span>
</code></pre></div></div><h3 id="automatic-indentation-management">Automatic Indentation Management</h3><p>Text blocks automatically remove common leading whitespace:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"""
            This is indented in the code,
            but the common indentation is removed
            from the final string.
            """</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This is indented in the code,
but the common indentation is removed
from the final string.
</code></pre></div></div><p>The closing <code class="language-plaintext highlighter-rouge">"""</code> position determines the indentation baseline:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Closing delimiter at the start - removes all indentation</span>
<span class="nc">String</span> <span class="n">noIndent</span> <span class="o">=</span> <span class="s">"""
    Line 1
    Line 2
    """</span><span class="o">;</span>

<span class="c1">// Closing delimiter indented - preserves relative indentation</span>
<span class="nc">String</span> <span class="n">withIndent</span> <span class="o">=</span> <span class="s">"""
    Line 1
    Line 2
        """</span><span class="o">;</span>
</code></pre></div></div><h2 id="real-world-examples">Real-World Examples</h2><h3 id="1-json-configuration">1. JSON Configuration</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfigGenerator</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">generateDatabaseConfig</span><span class="o">(</span><span class="nc">String</span> <span class="n">host</span><span class="o">,</span> <span class="kt">int</span> <span class="n">port</span><span class="o">,</span> <span class="nc">String</span> <span class="n">database</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"""
            {
              "</span><span class="n">database</span><span class="s">": {
                "</span><span class="n">host</span><span class="s">": "</span><span class="o">%</span><span class="n">s</span><span class="s">",
                "</span><span class="n">port</span><span class="s">": %d,
                "</span><span class="n">name</span><span class="s">": "</span><span class="o">%</span><span class="n">s</span><span class="s">",
                "</span><span class="n">pool</span><span class="s">": {
                  "</span><span class="n">minSize</span><span class="s">": 5,
                  "</span><span class="n">maxSize</span><span class="s">": 20,
                  "</span><span class="n">timeout</span><span class="s">": 30000
                }
              }
            }
            """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">,</span> <span class="n">database</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">generateUserJson</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">roles</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">rolesJson</span> <span class="o">=</span> <span class="n">roles</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">role</span> <span class="o">-&gt;</span> <span class="s">"\""</span> <span class="o">+</span> <span class="n">role</span> <span class="o">+</span> <span class="s">"\""</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">", "</span><span class="o">));</span>
            
        <span class="k">return</span> <span class="s">"""
            {
              "</span><span class="n">user</span><span class="s">": {
                "</span><span class="n">name</span><span class="s">": "</span><span class="o">%</span><span class="n">s</span><span class="s">",
                "</span><span class="n">email</span><span class="s">": "</span><span class="o">%</span><span class="n">s</span><span class="s">",
                "</span><span class="n">roles</span><span class="s">": [%s],
                "</span><span class="n">active</span><span class="s">": true
              }
            }
            """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">email</span><span class="o">,</span> <span class="n">rolesJson</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="2-sql-queries">2. SQL Queries</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRepository</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUsersWithOrdersQuery</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"""
            SELECT 
                u.id,
                u.name,
                u.email,
                COUNT(o.id) as order_count,
                SUM(o.total) as total_spent
            FROM users u
            LEFT JOIN orders o ON u.id = o.user_id
            WHERE u.active = true
            GROUP BY u.id, u.name, u.email
            HAVING COUNT(o.id) &gt; 0
            ORDER BY total_spent DESC
            LIMIT 100
            """</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getComplexReportQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">startDate</span><span class="o">,</span> <span class="nc">String</span> <span class="n">endDate</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"""
            WITH monthly_sales AS (
                SELECT 
                    DATE_TRUNC('month', order_date) as month,
                    SUM(total) as revenue
                FROM orders
                WHERE order_date BETWEEN '%s' AND '%s'
                GROUP BY month
            )
            SELECT 
                month,
                revenue,
                LAG(revenue) OVER (ORDER BY month) as prev_month_revenue,
                revenue - LAG(revenue) OVER (ORDER BY month) as growth
            FROM monthly_sales
            ORDER BY month DESC
            """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">startDate</span><span class="o">,</span> <span class="n">endDate</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="3-html-templates">3. HTML Templates</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailTemplateGenerator</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">generateWelcomeEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">userName</span><span class="o">,</span> <span class="nc">String</span> <span class="n">activationLink</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"""
            &lt;!DOCTYPE html&gt;
            &lt;html&gt;
            &lt;head&gt;
                &lt;style&gt;
                    body { font-family: Arial, sans-serif; }
                    .container { max-width: 600px; margin: 0 auto; }
                    .button {
                        background-color: #4CAF50;
                        color: white;
                        padding: 15px 32px;
                        text-decoration: none;
                        display: inline-block;
                    }
                &lt;/style&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;div class="</span><span class="n">container</span><span class="s">"&gt;
                    &lt;h1&gt;Welcome, %s!&lt;/h1&gt;
                    &lt;p&gt;Thank you for joining our platform.&lt;/p&gt;
                    &lt;p&gt;Please click the button below to activate your account:&lt;/p&gt;
                    &lt;a href="</span><span class="o">%</span><span class="n">s</span><span class="s">" class="</span><span class="n">button</span><span class="s">"&gt;Activate Account&lt;/a&gt;
                    &lt;p&gt;If you didn't create this account, please ignore this email.&lt;/p&gt;
                &lt;/div&gt;
            &lt;/body&gt;
            &lt;/html&gt;
            """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="n">activationLink</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="4-xml-documents">4. XML Documents</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XmlGenerator</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">generateProductXml</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">double</span> <span class="n">price</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">categories</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">categoriesXml</span> <span class="o">=</span> <span class="n">categories</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">cat</span> <span class="o">-&gt;</span> <span class="s">"        &lt;category&gt;"</span> <span class="o">+</span> <span class="n">cat</span> <span class="o">+</span> <span class="s">"&lt;/category&gt;"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">"\n"</span><span class="o">));</span>
            
        <span class="k">return</span> <span class="s">"""
            &lt;?xml version="</span><span class="mf">1.0</span><span class="s">" encoding="</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">"?&gt;
            &lt;product&gt;
                &lt;id&gt;%s&lt;/id&gt;
                &lt;name&gt;%s&lt;/name&gt;
                &lt;price currency="</span><span class="no">USD</span><span class="s">"&gt;%.2f&lt;/price&gt;
                &lt;categories&gt;
            %s
                &lt;/categories&gt;
            &lt;/product&gt;
            """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">price</span><span class="o">,</span> <span class="n">categoriesXml</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="string-interpolation-with-formatted">String Interpolation with formatted()</h2><p>Text blocks work seamlessly with the <code class="language-plaintext highlighter-rouge">formatted()</code> method (or <code class="language-plaintext highlighter-rouge">String.format()</code>):</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Alice"</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">30</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"""
    User Profile:
    -------------
    Name: %s
    Age: %d
    Status: %s
    """</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">age</span><span class="o">,</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span> <span class="o">?</span> <span class="s">"Adult"</span> <span class="o">:</span> <span class="s">"Minor"</span><span class="o">);</span>
</code></pre></div></div><h2 id="escape-sequences-still-work">Escape Sequences Still Work</h2><p>You can still use escape sequences when needed:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">withEscapes</span> <span class="o">=</span> <span class="s">"""
    Line 1\tTabbed
    Line 2\t\tDouble tabbed
    Quote: \"Hello\"
    Backslash: \\
    """</span><span class="o">;</span>
</code></pre></div></div><h2 id="preserving-trailing-whitespace">Preserving Trailing Whitespace</h2><p>Use <code class="language-plaintext highlighter-rouge">\s</code> to preserve trailing spaces:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">withTrailingSpace</span> <span class="o">=</span> <span class="s">"""
    This line has trailing space\s
    This line doesn't
    """</span><span class="o">;</span>
</code></pre></div></div><h2 id="line-continuation">Line Continuation</h2><p>Use <code class="language-plaintext highlighter-rouge">\</code> at the end of a line to join it with the next:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">oneLine</span> <span class="o">=</span> <span class="s">"""
    This is all \
    one \
    line.
    """</span><span class="o">;</span>
<span class="c1">// Result: "This is all one line."</span>
</code></pre></div></div><h2 id="best-practices">Best Practices</h2><h3 id="1-position-the-closing-delimiter-carefully">1. <strong>Position the Closing Delimiter Carefully</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Good - closing delimiter determines baseline indentation</span>
<span class="nc">String</span> <span class="n">good</span> <span class="o">=</span> <span class="s">"""
    Content here
    More content
    """</span><span class="o">;</span>

<span class="c1">// Also good - explicit about no indentation</span>
<span class="nc">String</span> <span class="n">alsoGood</span> <span class="o">=</span> <span class="s">"""
Content here
More content
"""</span><span class="o">;</span>
</code></pre></div></div><h3 id="2-use-for-multi-line-content-only">2. <strong>Use for Multi-Line Content Only</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Don't use text blocks for single-line strings</span>
<span class="nc">String</span> <span class="n">bad</span> <span class="o">=</span> <span class="s">"""
    Just one line
    """</span><span class="o">;</span>

<span class="c1">// Use regular strings instead</span>
<span class="nc">String</span> <span class="n">good</span> <span class="o">=</span> <span class="s">"Just one line"</span><span class="o">;</span>
</code></pre></div></div><h3 id="3-combine-with-string-methods">3. <strong>Combine with String Methods</strong></h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">template</span> <span class="o">=</span> <span class="s">"""
    {
      "</span><span class="n">name</span><span class="s">": "</span><span class="o">%</span><span class="n">s</span><span class="s">",
      "</span><span class="n">value</span><span class="s">": %d
    }
    """</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="na">formatted</span><span class="o">(</span><span class="s">"example"</span><span class="o">,</span> <span class="mi">42</span><span class="o">)</span>
                      <span class="o">.</span><span class="na">trim</span><span class="o">()</span>
                      <span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">"\\s+"</span><span class="o">,</span> <span class="s">" "</span><span class="o">);</span>
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>Text Blocks are a game-changer for working with multi-line strings in Java. They make code more readable, reduce errors, and simplify maintenance. Whether you’re working with JSON, SQL, HTML, or any other multi-line format, text blocks provide a clean, intuitive syntax that feels natural and keeps your code organized.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Write cleaner multi-line strings in Java 17 with Text Blocks, perfect for JSON, SQL, HTML, and more.]]></summary></entry><entry><title type="html">Pattern Matching for instanceof (Java 17)</title><link href="https://thoughtstopen.com/java-17-pattern-matching-instanceof/" rel="alternate" type="text/html" title="Pattern Matching for instanceof (Java 17)"/><published>2025-11-10T09:00:00-07:00</published><updated>2025-11-10T09:00:00-07:00</updated><id>https://thoughtstopen.com/java-17-pattern-matching-instanceof</id><content type="html" xml:base="https://thoughtstopen.com/java-17-pattern-matching-instanceof/"><![CDATA[<p>Pattern Matching for <code class="language-plaintext highlighter-rouge">instanceof</code>, finalized in Java 16 and included in Java 17 through JEP 394, revolutionizes how we perform type checks and casts in Java. This feature eliminates the redundant casting that traditionally follows an <code class="language-plaintext highlighter-rouge">instanceof</code> check, making your code more concise and less error-prone.</p><h2 id="the-old-way-vs-the-new-way">The Old Way vs. The New Way</h2><h3 id="before-java-17-traditional-approach">Before Java 17 (Traditional Approach)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>  <span class="c1">// Redundant cast</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"String length: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="with-java-17-pattern-matching">With Java 17 (Pattern Matching)</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">// Type test + binding in one</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"String length: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>The pattern variable <code class="language-plaintext highlighter-rouge">str</code> is automatically created and scoped to the <code class="language-plaintext highlighter-rouge">if</code> block, eliminating the need for an explicit cast.</p><h2 id="how-it-works">How It Works</h2><p>When you use pattern matching with <code class="language-plaintext highlighter-rouge">instanceof</code>, Java performs two operations simultaneously:</p><ol><li><strong>Type Test</strong>: Checks if the object is an instance of the specified type</li><li><strong>Binding</strong>: If the test succeeds, creates a new variable of that type</li></ol><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 'str' is available here and is of type String</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
<span class="o">}</span>
<span class="c1">// 'str' is NOT available here (out of scope)</span>
</code></pre></div></div><h2 id="scope-rules">Scope Rules</h2><p>The pattern variable is only in scope where the compiler can guarantee the <code class="language-plaintext highlighter-rouge">instanceof</code> check succeeded:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">demonstrateScope</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Pattern variable in if statement</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>  <span class="c1">// ✓ str is in scope</span>
    <span class="o">}</span>
    <span class="c1">// System.out.println(str.length());  // ✗ Compile error: str out of scope</span>
    
    <span class="c1">// Pattern variable with logical AND</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Long string: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">);</span>  <span class="c1">// ✓ str is in scope</span>
    <span class="o">}</span>
    
    <span class="c1">// Pattern variable with logical OR</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">||</span> <span class="n">str</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>  <span class="c1">// ✗ Compile error</span>
        <span class="c1">// str might not be initialized if first condition is false</span>
    <span class="o">}</span>
    
    <span class="c1">// Pattern variable with negation</span>
    <span class="k">if</span> <span class="o">(!(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// System.out.println(str);  // ✗ str is NOT in scope here</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>  <span class="c1">// ✓ str IS in scope here</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="real-world-example-processing-different-message-types">Real-World Example: Processing Different Message Types</h2><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">interface</span> <span class="nc">Message</span> <span class="n">permits</span> <span class="nc">TextMessage</span><span class="o">,</span> <span class="nc">ImageMessage</span><span class="o">,</span> <span class="nc">VideoMessage</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="n">record</span> <span class="nf">TextMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">content</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">ImageMessage</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="nc">String</span> <span class="n">caption</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">VideoMessage</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span><span class="o">,</span> <span class="kt">int</span> <span class="n">duration</span><span class="o">,</span> <span class="nc">String</span> <span class="n">sender</span><span class="o">)</span> <span class="kd">implements</span> <span class="nc">Message</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MessageProcessor</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="nc">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Text from "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">sender</span><span class="o">()</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">());</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">ImageMessage</span> <span class="n">img</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Image from "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">sender</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caption: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">caption</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Size: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">data</span><span class="o">().</span><span class="na">length</span> <span class="o">+</span> <span class="s">" bytes"</span><span class="o">);</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">VideoMessage</span> <span class="n">vid</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Video from "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">sender</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Duration: "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">duration</span><span class="o">()</span> <span class="o">+</span> <span class="s">" seconds"</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Size: "</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">data</span><span class="o">().</span><span class="na">length</span> <span class="o">+</span> <span class="s">" bytes"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessageSummary</span><span class="o">(</span><span class="nc">Message</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span> <span class="o">&amp;&amp;</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">().</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Long text message from "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">sender</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">TextMessage</span> <span class="n">txt</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Text: "</span> <span class="o">+</span> <span class="n">txt</span><span class="o">.</span><span class="na">content</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">ImageMessage</span> <span class="n">img</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Image: "</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">caption</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">VideoMessage</span> <span class="n">vid</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Video ("</span> <span class="o">+</span> <span class="n">vid</span><span class="o">.</span><span class="na">duration</span><span class="o">()</span> <span class="o">+</span> <span class="s">"s)"</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">"Unknown message type"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="combining-with-logical-operators">Combining with Logical Operators</h2><p>Pattern matching works seamlessly with logical operators:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">validateInput</span><span class="o">(</span><span class="nc">Object</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Using AND to add additional conditions</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">str</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Valid string: "</span> <span class="o">+</span> <span class="n">str</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="c1">// Using AND with multiple pattern variables</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">input</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"\\d+"</span><span class="o">))</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Parsed number: "</span> <span class="o">+</span> <span class="n">number</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="practical-example-shape-area-calculator">Practical Example: Shape Area Calculator</h2><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Circle</span><span class="o">(</span><span class="kt">double</span> <span class="n">radius</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getRadius</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">width</span><span class="o">,</span> <span class="kt">double</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getWidth</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getHeight</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShapeAnalyzer</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">analyzeShape</span><span class="o">(</span><span class="nc">Shape</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">c</span><span class="o">.</span><span class="na">getRadius</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Large circle with area: "</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Small circle with area: "</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span> <span class="o">&amp;&amp;</span> <span class="n">r</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">==</span> <span class="n">r</span><span class="o">.</span><span class="na">getHeight</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Square with area: "</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
            
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Rectangle with area: "</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">area</span><span class="o">();</span>
        <span class="o">}</span>
        
        <span class="k">return</span> <span class="s">"Unknown shape"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculatePerimeter</span><span class="o">(</span><span class="nc">Shape</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="na">getRadius</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="na">getHeight</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="benefits">Benefits</h2><h3 id="1-reduced-boilerplate">1. <strong>Reduced Boilerplate</strong></h3><p>No more redundant casting after <code class="language-plaintext highlighter-rouge">instanceof</code> checks.</p><h3 id="2-improved-readability">2. <strong>Improved Readability</strong></h3><p>The intent is clearer when the type test and binding happen together.</p><h3 id="3-fewer-errors">3. <strong>Fewer Errors</strong></h3><p>Eliminates the possibility of casting to the wrong type after an <code class="language-plaintext highlighter-rouge">instanceof</code> check.</p><h3 id="4-better-performance">4. <strong>Better Performance</strong></h3><p>The JVM only performs the type check once, not twice (once for <code class="language-plaintext highlighter-rouge">instanceof</code> and once for the cast).</p><h2 id="common-patterns">Common Patterns</h2><h3 id="null-safe-processing">Null-Safe Processing</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">int</span> <span class="nf">getStringLength</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>  <span class="c1">// null or not a String</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="nested-conditions">Nested Conditions</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">processData</span><span class="o">(</span><span class="nc">Object</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">data</span> <span class="k">instanceof</span> <span class="nc">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">firstStr</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"First element: "</span> <span class="o">+</span> <span class="n">firstStr</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="early-returns">Early Returns</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">formatValue</span><span class="o">(</span><span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(!(</span><span class="n">value</span> <span class="k">instanceof</span> <span class="nc">Number</span> <span class="n">num</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Not a number"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// num is in scope for the rest of the method</span>
    <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%.2f"</span><span class="o">,</span> <span class="n">num</span><span class="o">.</span><span class="na">doubleValue</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>Pattern Matching for <code class="language-plaintext highlighter-rouge">instanceof</code> is a simple yet powerful feature that makes Java code more concise and readable. By combining type testing with variable binding, it eliminates redundant casts and reduces the potential for errors. This feature works particularly well with sealed classes and modern Java patterns, making your code both safer and more expressive.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Simplify type checking and casting in Java 17 with Pattern Matching for instanceof, eliminating boilerplate code.]]></summary></entry><entry><title type="html">Sealed Classes (Java 17)</title><link href="https://thoughtstopen.com/java-17-sealed-classes/" rel="alternate" type="text/html" title="Sealed Classes (Java 17)"/><published>2025-11-05T09:00:00-07:00</published><updated>2025-11-05T09:00:00-07:00</updated><id>https://thoughtstopen.com/java-17-sealed-classes</id><content type="html" xml:base="https://thoughtstopen.com/java-17-sealed-classes/"><![CDATA[<p>Sealed Classes, finalized in Java 17 through JEP 409, introduce a powerful mechanism for controlling inheritance in Java. This feature allows you to explicitly declare which classes are permitted to extend or implement a sealed type, giving you unprecedented control over your class hierarchies.</p><h2 id="what-are-sealed-classes">What Are Sealed Classes?</h2><p>A <strong>sealed class</strong> or interface restricts which other classes or interfaces may extend or implement it. You declare a class as <code class="language-plaintext highlighter-rouge">sealed</code> and use the <code class="language-plaintext highlighter-rouge">permits</code> clause to specify the allowed subclasses.</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="n">permits</span> <span class="nc">Circle</span><span class="o">,</span> <span class="nc">Rectangle</span><span class="o">,</span> <span class="nc">Triangle</span> <span class="o">{</span>
    <span class="c1">// Common shape behavior</span>
<span class="o">}</span>
</code></pre></div></div><p>In this example, only <code class="language-plaintext highlighter-rouge">Circle</code>, <code class="language-plaintext highlighter-rouge">Rectangle</code>, and <code class="language-plaintext highlighter-rouge">Triangle</code> are allowed to extend <code class="language-plaintext highlighter-rouge">Shape</code>. Any attempt by another class to extend <code class="language-plaintext highlighter-rouge">Shape</code> will result in a compile-time error.</p><h2 id="why-use-sealed-classes">Why Use Sealed Classes?</h2><h3 id="1-domain-modeling">1. <strong>Domain Modeling</strong></h3><p>Sealed classes are perfect for modeling closed hierarchies where you know all possible subtypes in advance.</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">class</span> <span class="nc">Vehicle</span> <span class="n">permits</span> <span class="nc">Car</span><span class="o">,</span> <span class="nc">Truck</span><span class="o">,</span> <span class="nc">Motorcycle</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">licensePlate</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Vehicle</span><span class="o">(</span><span class="nc">String</span> <span class="n">licensePlate</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">licensePlate</span> <span class="o">=</span> <span class="n">licensePlate</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getLicensePlate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">licensePlate</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="kd">extends</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">numberOfDoors</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Car</span><span class="o">(</span><span class="nc">String</span> <span class="n">licensePlate</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numberOfDoors</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">licensePlate</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">numberOfDoors</span> <span class="o">=</span> <span class="n">numberOfDoors</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="nc">Truck</span> <span class="kd">extends</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">cargoCapacity</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Truck</span><span class="o">(</span><span class="nc">String</span> <span class="n">licensePlate</span><span class="o">,</span> <span class="kt">double</span> <span class="n">cargoCapacity</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">licensePlate</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cargoCapacity</span> <span class="o">=</span> <span class="n">cargoCapacity</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="nc">Motorcycle</span> <span class="kd">extends</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">hasSidecar</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Motorcycle</span><span class="o">(</span><span class="nc">String</span> <span class="n">licensePlate</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">hasSidecar</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">licensePlate</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">hasSidecar</span> <span class="o">=</span> <span class="n">hasSidecar</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>This design makes it clear that <code class="language-plaintext highlighter-rouge">Vehicle</code> has exactly three subtypes, preventing unexpected extensions.</p><h3 id="2-enhanced-security">2. <strong>Enhanced Security</strong></h3><p>By controlling the inheritance hierarchy, you prevent malicious or accidental subclassing that could compromise your application’s security or business logic.</p><h3 id="3-better-pattern-matching">3. <strong>Better Pattern Matching</strong></h3><p>Sealed classes work beautifully with pattern matching for <code class="language-plaintext highlighter-rouge">switch</code> expressions, enabling exhaustiveness checking.</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateTax</span><span class="o">(</span><span class="nc">Vehicle</span> <span class="n">vehicle</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">switch</span> <span class="o">(</span><span class="n">vehicle</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">Car</span> <span class="n">c</span> <span class="o">-&gt;</span> <span class="mf">100.0</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">Truck</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="mf">200.0</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">Motorcycle</span> <span class="n">m</span> <span class="o">-&gt;</span> <span class="mf">50.0</span><span class="o">;</span>
        <span class="c1">// No default needed - compiler knows all cases are covered!</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="permitted-subclass-modifiers">Permitted Subclass Modifiers</h2><p>Each permitted subclass must be declared with one of three modifiers:</p><h3 id="1-final---no-further-subclassing">1. <strong>final</strong> - No Further Subclassing</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Circle</span><span class="o">(</span><span class="kt">double</span> <span class="n">radius</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">radius</span> <span class="o">=</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">PI</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="2-sealed---controlled-further-subclassing">2. <strong>sealed</strong> - Controlled Further Subclassing</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="n">permits</span> <span class="nc">Square</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">width</span><span class="o">,</span> <span class="kt">double</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">width</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Square</span> <span class="kd">extends</span> <span class="nc">Rectangle</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Square</span><span class="o">(</span><span class="kt">double</span> <span class="n">side</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">side</span><span class="o">,</span> <span class="n">side</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="3-non-sealed---reopens-the-hierarchy">3. <strong>non-sealed</strong> - Reopens the Hierarchy</h3><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">non</span><span class="o">-</span><span class="n">sealed</span> <span class="kd">class</span> <span class="nc">Triangle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">base</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Triangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">base</span><span class="o">,</span> <span class="kt">double</span> <span class="n">height</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">base</span> <span class="o">=</span> <span class="n">base</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">base</span> <span class="o">*</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Now any class can extend Triangle</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EquilateralTriangle</span> <span class="kd">extends</span> <span class="nc">Triangle</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">EquilateralTriangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">side</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">side</span><span class="o">,</span> <span class="n">side</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="real-world-example-payment-processing">Real-World Example: Payment Processing</h2><p>Here’s a practical example modeling different payment methods:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">interface</span> <span class="nc">Payment</span> <span class="n">permits</span> <span class="nc">CreditCardPayment</span><span class="o">,</span> <span class="nc">PayPalPayment</span><span class="o">,</span> <span class="nc">BankTransferPayment</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">CreditCardPayment</span> <span class="kd">implements</span> <span class="nc">Payment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">cardNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">cvv</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">CreditCardPayment</span><span class="o">(</span><span class="nc">String</span> <span class="n">cardNumber</span><span class="o">,</span> <span class="nc">String</span> <span class="n">cvv</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cardNumber</span> <span class="o">=</span> <span class="n">cardNumber</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cvv</span> <span class="o">=</span> <span class="n">cvv</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Processing $"</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">+</span> <span class="s">" via credit card"</span><span class="o">);</span>
        <span class="c1">// Credit card processing logic</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">PayPalPayment</span> <span class="kd">implements</span> <span class="nc">Payment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">PayPalPayment</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Processing $"</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">+</span> <span class="s">" via PayPal"</span><span class="o">);</span>
        <span class="c1">// PayPal processing logic</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">BankTransferPayment</span> <span class="kd">implements</span> <span class="nc">Payment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">accountNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">routingNumber</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">BankTransferPayment</span><span class="o">(</span><span class="nc">String</span> <span class="n">accountNumber</span><span class="o">,</span> <span class="nc">String</span> <span class="n">routingNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">accountNumber</span> <span class="o">=</span> <span class="n">accountNumber</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">routingNumber</span> <span class="o">=</span> <span class="n">routingNumber</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Processing $"</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">+</span> <span class="s">" via bank transfer"</span><span class="o">);</span>
        <span class="c1">// Bank transfer processing logic</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Now you can safely process payments knowing all possible payment types:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">executePayment</span><span class="o">(</span><span class="nc">Payment</span> <span class="n">payment</span><span class="o">,</span> <span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">paymentType</span> <span class="o">=</span> <span class="k">switch</span> <span class="o">(</span><span class="n">payment</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">CreditCardPayment</span> <span class="n">cc</span> <span class="o">-&gt;</span> <span class="s">"Credit Card"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">PayPalPayment</span> <span class="n">pp</span> <span class="o">-&gt;</span> <span class="s">"PayPal"</span><span class="o">;</span>
        <span class="k">case</span> <span class="nc">BankTransferPayment</span> <span class="n">bt</span> <span class="o">-&gt;</span> <span class="s">"Bank Transfer"</span><span class="o">;</span>
    <span class="o">};</span>
    
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Using "</span> <span class="o">+</span> <span class="n">paymentType</span><span class="o">);</span>
    <span class="n">payment</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">amount</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="module-and-package-constraints">Module and Package Constraints</h2><p>Sealed classes and their permitted subclasses must be in the same module. If they’re in an unnamed module, they must also be in the same package. This ensures that the sealed hierarchy is well-defined and accessible.</p><h2 id="reflection-support">Reflection Support</h2><p>Java 17 added reflection support for sealed classes:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Class</span><span class="o">&lt;</span><span class="nc">Shape</span><span class="o">&gt;</span> <span class="n">shapeClass</span> <span class="o">=</span> <span class="nc">Shape</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(</span><span class="n">shapeClass</span><span class="o">.</span><span class="na">isSealed</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">permittedSubclasses</span> <span class="o">=</span> <span class="n">shapeClass</span><span class="o">.</span><span class="na">getPermittedSubclasses</span><span class="o">();</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">subclass</span> <span class="o">:</span> <span class="n">permittedSubclasses</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Permitted: "</span> <span class="o">+</span> <span class="n">subclass</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="conclusion">Conclusion</h2><p>Sealed Classes in Java 17 provide a robust way to model closed hierarchies, improve code maintainability, and enhance security. By explicitly controlling which classes can extend your types, you create more predictable and safer code. Combined with pattern matching, sealed classes enable the compiler to verify exhaustiveness, catching potential bugs at compile time rather than runtime.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Master Sealed Classes in Java 17 to control inheritance hierarchies and build more maintainable, secure domain models.]]></summary></entry><entry><title type="html">Java 17 Features</title><link href="https://thoughtstopen.com/java-17-features/" rel="alternate" type="text/html" title="Java 17 Features"/><published>2025-11-01T10:00:00-06:00</published><updated>2025-11-01T10:00:00-06:00</updated><id>https://thoughtstopen.com/java-17-features</id><content type="html" xml:base="https://thoughtstopen.com/java-17-features/"><![CDATA[<p>Java 17, released on September 14, 2021, is a Long-Term Support (LTS) release that brings significant enhancements to the Java language and platform. As an LTS version, Java 17 receives extended support until at least September 2029, making it an excellent choice for production applications.</p><p>This release introduces several powerful features that improve code quality, reduce boilerplate, and enhance developer productivity. Let’s explore the key features that make Java 17 a milestone release.</p><h2 id="key-features">Key Features</h2><ul><li><h2 id="sealed-classes"><a href="/java-17-sealed-classes/">Sealed Classes</a></h2><p>Sealed classes provide fine-grained control over inheritance hierarchies by explicitly declaring which classes can extend or implement a type. This feature is perfect for modeling closed domain hierarchies and works beautifully with pattern matching.</p></li></ul><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="n">sealed</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="n">permits</span> <span class="nc">Circle</span><span class="o">,</span> <span class="nc">Rectangle</span><span class="o">,</span> <span class="nc">Triangle</span> <span class="o">{</span>
    <span class="c1">// Only Circle, Rectangle, and Triangle can extend Shape</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div><p><strong>Benefits:</strong></p><ul><li>Better domain modeling with closed hierarchies</li><li>Enhanced security by preventing unexpected subclassing</li><li>Compile-time exhaustiveness checking with pattern matching</li><li><p>Clearer API contracts</p></li><li><h2 id="pattern-matching-for-instanceof"><a href="/java-17-pattern-matching-instanceof/">Pattern Matching for instanceof</a></h2><p>This feature eliminates the redundant casting that traditionally follows an <code class="language-plaintext highlighter-rouge">instanceof</code> check by combining type testing with variable binding in a single operation.</p></li></ul><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Before Java 17</span>
<span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
<span class="o">}</span>

<span class="c1">// With Java 17</span>
<span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div><p><strong>Benefits:</strong></p><ul><li>Reduced boilerplate code</li><li>Improved readability</li><li>Fewer casting errors</li><li><p>Better performance (single type check)</p></li><li><h2 id="text-blocks"><a href="/java-17-text-blocks/">Text Blocks</a></h2><p>Text blocks use triple-double quotes (<code class="language-plaintext highlighter-rouge">"""</code>) to create multi-line string literals that preserve formatting and eliminate the need for escape sequences. Perfect for JSON, SQL, HTML, and other multi-line content.</p></li></ul><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="s">"""
    {
      "</span><span class="n">name</span><span class="s">": "</span><span class="nc">John</span> <span class="nc">Doe</span><span class="s">",
      "</span><span class="n">age</span><span class="s">": 30,
      "</span><span class="n">email</span><span class="s">": "</span><span class="n">john</span><span class="nd">@example</span><span class="o">.</span><span class="na">com</span><span class="s">"
    }
    """</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"""
    SELECT users.name, users.email, orders.total
    FROM users
    JOIN orders ON users.id = orders.user_id
    WHERE orders.status = 'completed'
    ORDER BY orders.total DESC
    """</span><span class="o">;</span>
</code></pre></div></div><p><strong>Benefits:</strong></p><ul><li>Dramatically improved readability for multi-line strings</li><li>No more escape sequence clutter</li><li>Automatic indentation management</li><li><p>Easier maintenance of embedded content</p></li><li><h2 id="records"><a href="/java-17-records/">Records</a></h2><p>Records provide a concise syntax for creating immutable data carrier classes. The compiler automatically generates constructors, accessors, <code class="language-plaintext highlighter-rouge">equals()</code>, <code class="language-plaintext highlighter-rouge">hashCode()</code>, and <code class="language-plaintext highlighter-rouge">toString()</code> methods.</p></li></ul><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Traditional class: 40+ lines of boilerplate</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>
    <span class="c1">// ... constructors, getters, equals, hashCode, toString</span>
<span class="o">}</span>

<span class="c1">// Record: Just one line!</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">Person</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{}</span>
</code></pre></div></div><p><strong>Benefits:</strong></p><ul><li>Massive reduction in boilerplate code</li><li>Immutability by default</li><li>Perfect for DTOs and value objects</li><li><p>Automatic implementation of common methods</p></li><li><h2 id="enhanced-pseudo-random-number-generators"><a href="/java-17-random-generators/">Enhanced Pseudo-Random Number Generators</a></h2><p>Java 17 introduces a new framework for random number generation with multiple high-quality algorithms, better stream support, and improved parallel processing capabilities.</p></li></ul><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// New flexible API</span>
<span class="nc">RandomGenerator</span> <span class="n">rng</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L64X128MixRandom"</span><span class="o">);</span>

<span class="c1">// Excellent stream support</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">randomNumbers</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="na">ints</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
    <span class="o">.</span><span class="na">boxed</span><span class="o">()</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

<span class="c1">// Multiple algorithm choices</span>
<span class="nc">RandomGenerator</span> <span class="n">fast</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Xoshiro256PlusPlus"</span><span class="o">);</span>
<span class="nc">RandomGenerator</span> <span class="n">quality</span> <span class="o">=</span> <span class="nc">RandomGenerator</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"L128X256MixRandom"</span><span class="o">);</span>
</code></pre></div></div><p><strong>Benefits:</strong></p><ul><li>Multiple high-quality PRNG algorithms</li><li>Better stream and parallel processing support</li><li>Easy algorithm switching</li><li>Improved performance</li></ul><h2 id="why-upgrade-to-java-17">Why Upgrade to Java 17?</h2><h3 id="long-term-support">Long-Term Support</h3><p>As an LTS release, Java 17 receives extended support, making it ideal for production applications that require stability and long-term maintenance.</p><h3 id="modern-language-features">Modern Language Features</h3><p>The features in Java 17 represent years of evolution in the Java language, bringing it in line with modern programming paradigms while maintaining backward compatibility.</p><h3 id="improved-developer-productivity">Improved Developer Productivity</h3><p>Features like records, text blocks, and pattern matching significantly reduce boilerplate code, allowing developers to focus on business logic rather than ceremony.</p><h3 id="better-code-quality">Better Code Quality</h3><p>Sealed classes and pattern matching enable more expressive, type-safe code with compile-time guarantees that catch errors early.</p><h2 id="migration-path">Migration Path</h2><p>Java 17 maintains strong backward compatibility with previous versions. Most applications running on Java 11 (the previous LTS) can upgrade to Java 17 with minimal changes. The main considerations are:</p><ol><li><strong>Deprecated API Removals</strong>: Some deprecated APIs have been removed</li><li><strong>Strong Encapsulation</strong>: Internal JDK APIs are more strictly encapsulated</li><li><strong>Updated Dependencies</strong>: Ensure third-party libraries support Java 17</li></ol><h2 id="conclusion">Conclusion</h2><p>Java 17 is a significant milestone in Java’s evolution, combining stability as an LTS release with powerful new language features. Whether you’re building new applications or maintaining existing ones, Java 17 offers compelling reasons to upgrade:</p><ul><li><strong>Sealed Classes</strong> for better domain modeling</li><li><strong>Pattern Matching</strong> for cleaner type checks</li><li><strong>Text Blocks</strong> for readable multi-line strings</li><li><strong>Records</strong> for concise data classes</li><li><strong>Enhanced Random Generators</strong> for flexible randomness</li></ul><p>These features work together to make Java code more expressive, maintainable, and enjoyable to write. If you’re still on Java 11 or earlier, now is an excellent time to plan your migration to Java 17.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java17"/><summary type="html"><![CDATA[Explore the powerful features introduced in Java 17 LTS, including Sealed Classes, Pattern Matching, Text Blocks, Records, and enhanced random number generators.]]></summary></entry><entry><title type="html">Primitive Types in Patterns (Java 25)</title><link href="https://thoughtstopen.com/java-25-primitive-types-in-patterns/" rel="alternate" type="text/html" title="Primitive Types in Patterns (Java 25)"/><published>2025-09-28T10:45:00-06:00</published><updated>2025-09-28T10:45:00-06:00</updated><id>https://thoughtstopen.com/java-25-primitive-types-in-patterns</id><content type="html" xml:base="https://thoughtstopen.com/java-25-primitive-types-in-patterns/"><![CDATA[<h1 id="primitive-types-in-patterns-instanceof-and-switch-jep-507">Primitive Types in Patterns, instanceof, and switch (JEP 507)</h1><p>Pattern Matching has been revolutionizing Java for the past few versions. We’ve seen it with <code class="language-plaintext highlighter-rouge">instanceof</code>, then <code class="language-plaintext highlighter-rouge">switch</code> expressions, and then Record Patterns.</p><p>But there was always one limitation: it only worked with objects (reference types). You couldn’t use it directly with primitives like <code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">long</code>, or <code class="language-plaintext highlighter-rouge">double</code>.</p><p>Java 25 changes that with <strong>Primitive Types in Patterns</strong> (JEP 507 - Preview).</p><h2 id="why-do-we-need-this">Why do we need this?</h2><p>Previously, if you wanted to switch on different types, you had to worry about whether you were dealing with a boxed type (like <code class="language-plaintext highlighter-rouge">Integer</code>) or a primitive (<code class="language-plaintext highlighter-rouge">int</code>).</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Pre-Java 25</span>
<span class="nc">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="mi">42</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(</span><span class="n">obj</span> <span class="k">instanceof</span> <span class="nc">Integer</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// This works because 'obj' is an Integer (boxed)</span>
<span class="o">}</span>

<span class="c1">// But you couldn't do this easily with direct primitives in data processing</span>
</code></pre></div></div><h2 id="how-it-works-in-java-25">How it works in Java 25</h2><p>Now, <code class="language-plaintext highlighter-rouge">instanceof</code> and <code class="language-plaintext highlighter-rouge">switch</code> can handle direct primitive type patterns.</p><h3 id="type-testing-with-instanceof">Type Testing with <code class="language-plaintext highlighter-rouge">instanceof</code></h3><p>You can now check if a value “matches” a primitive type. This is particularly useful when dealing with very large numbers or widened types.</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">42</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(</span><span class="n">v</span> <span class="k">instanceof</span> <span class="kt">byte</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"It fits in a byte: "</span> <span class="o">+</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><p>Wait, <code class="language-plaintext highlighter-rouge">long</code> behaves like a <code class="language-plaintext highlighter-rouge">byte</code>? Yes! In pattern matching, <code class="language-plaintext highlighter-rouge">instanceof</code> for primitives checks if the value <strong>can be represented exactly</strong> by the target type without loss of information. Since <code class="language-plaintext highlighter-rouge">42</code> fits in a byte, it matches. If <code class="language-plaintext highlighter-rouge">v</code> was <code class="language-plaintext highlighter-rouge">1000</code>, it would not match <code class="language-plaintext highlighter-rouge">byte b</code>.</p><h3 id="switch-with-primitives">Switch with Primitives</h3><p>The real power shines in <code class="language-plaintext highlighter-rouge">switch</code> expressions. You can now mix and match primitives and objects (if applicable) or simply switch on types for validation.</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="mi">1</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"One"</span><span class="o">);</span>
        <span class="k">case</span> <span class="kt">byte</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Small number: "</span> <span class="o">+</span> <span class="n">b</span><span class="o">);</span>
        <span class="k">case</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Medium number: "</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
        <span class="k">default</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Huge number"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>If you call <code class="language-plaintext highlighter-rouge">process(100)</code>, it matches <code class="language-plaintext highlighter-rouge">case byte b</code>. If you call <code class="language-plaintext highlighter-rouge">process(100000)</code>, it matches <code class="language-plaintext highlighter-rouge">case int i</code>.</p><h2 id="unified-type-system">Unified Type System</h2><p>This feature is a huge step towards unifying primitives and objects in Java. It allows we to write more generic data processing logic without constantly boxing and unboxing values or writing cumbersome range checks (e.g., <code class="language-plaintext highlighter-rouge">if (v &gt;= Byte.MIN_VALUE &amp;&amp; v &lt;= Byte.MAX_VALUE)</code>).</p><p><strong>Note:</strong> This is a <strong>Preview</strong> feature in Java 25, so you’ll need to enable preview flags to use it!</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java25"/><summary type="html"><![CDATA[Java 25 extends pattern matching to primitive types like int and long, unifying the type system.]]></summary></entry><entry><title type="html">Module Import Declarations (Java 25)</title><link href="https://thoughtstopen.com/java-25-module-import-declarations/" rel="alternate" type="text/html" title="Module Import Declarations (Java 25)"/><published>2025-09-26T10:30:00-06:00</published><updated>2025-09-26T10:30:00-06:00</updated><id>https://thoughtstopen.com/java-25-module-import-declarations</id><content type="html" xml:base="https://thoughtstopen.com/java-25-module-import-declarations/"><![CDATA[<h1 id="module-import-declarations-jep-511">Module Import Declarations (JEP 511)</h1><p>How many lines of your Java files are just <code class="language-plaintext highlighter-rouge">import</code> statements? 10? 20? 50?</p><p>We’ve all been there:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.function.Function</span><span class="o">;</span>
<span class="c1">// ... and on and on</span>
</code></pre></div></div><p>Wildcard imports (<code class="language-plaintext highlighter-rouge">import java.util.*</code>) help, but they are limited to a single package. If you use classes from <code class="language-plaintext highlighter-rouge">java.util</code>, <code class="language-plaintext highlighter-rouge">java.io</code>, and <code class="language-plaintext highlighter-rouge">java.net</code>, you still need multiple lines.</p><p>Java 25 introduces <strong>Module Import Declarations</strong> (JEP 511), a powerful way to import <em>everything</em> a module exports with a single line.</p><h2 id="the-power-of-import-module">The Power of <code class="language-plaintext highlighter-rouge">import module</code></h2><p>With this new feature, you can import all the public classes and interfaces from an entire module.</p><p>For example, to access everything in the core Java libraries (the <code class="language-plaintext highlighter-rouge">java.base</code> module), you can write:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">module</span> <span class="n">java</span><span class="o">.</span><span class="na">base</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModuleImportExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">);</span> <span class="c1">// from java.util</span>
        <span class="nc">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"test.txt"</span><span class="o">);</span>           <span class="c1">// from java.io</span>
        <span class="nc">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">();</span>               <span class="c1">// from java.net</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Wait, where are the imports for <code class="language-plaintext highlighter-rouge">List</code>, <code class="language-plaintext highlighter-rouge">File</code>, and <code class="language-plaintext highlighter-rouge">Socket</code>? They are all brought in by <code class="language-plaintext highlighter-rouge">import module java.base;</code>!</p><p>Since <code class="language-plaintext highlighter-rouge">java.base</code> contains packages like <code class="language-plaintext highlighter-rouge">java.lang</code>, <code class="language-plaintext highlighter-rouge">java.io</code>, <code class="language-plaintext highlighter-rouge">java.net</code>, <code class="language-plaintext highlighter-rouge">java.util</code>, and more, importing the module makes all of their public types available to your code.</p><h2 id="handling-naming-conflicts">Handling naming conflicts</h2><p>Since you are importing so many classes, what if there is a conflict? For example, <code class="language-plaintext highlighter-rouge">java.util.Date</code> and <code class="language-plaintext highlighter-rouge">java.sql.Date</code> (if you imported <code class="language-plaintext highlighter-rouge">java.sql</code>).</p><p>Java handles this gracefully. If you use a class name that is ambiguous (exists in multiple imported packages), the compiler will give an error, and you simply need to <strong>explicitly import</strong> the specific class you want to resolve the ambiguity:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">module</span> <span class="n">java</span><span class="o">.</span><span class="na">base</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">module</span> <span class="n">java</span><span class="o">.</span><span class="na">sql</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.sql.Date</span><span class="o">;</span> <span class="c1">// Resolve conflict for 'Date'</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">conflicts</span> <span class="o">{</span>
    <span class="nc">Date</span> <span class="n">sqlDate</span><span class="o">;</span> <span class="c1">// Uses java.sql.Date</span>
<span class="o">}</span>
</code></pre></div></div><h2 id="why-use-this">Why use this?</h2><ol><li><strong>Simplicity</strong>: Especially for learning and prototyping, it removes the friction of hunting down packages.</li><li><strong>Readability</strong>: Reduces visual noise at the top of your files.</li><li><strong>Convenience</strong>: Great for “Java playgrounds” or scripts (especially when combined with <strong>Compact Source Files</strong>!).</li></ol><p>This feature essentially brings the convenience of “import everything” that other languages enjoy, while keeping Java’s strong module system structure.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java25"/><summary type="html"><![CDATA[Say goodbye to import clutter with Module Import Declarations in Java 25.]]></summary></entry><entry><title type="html">Flexible Constructor Bodies (Java 25)</title><link href="https://thoughtstopen.com/java-25-flexible-constructor-bodies/" rel="alternate" type="text/html" title="Flexible Constructor Bodies (Java 25)"/><published>2025-09-24T10:15:00-06:00</published><updated>2025-09-24T10:15:00-06:00</updated><id>https://thoughtstopen.com/java-25-flexible-constructor-bodies</id><content type="html" xml:base="https://thoughtstopen.com/java-25-flexible-constructor-bodies/"><![CDATA[<h1 id="flexible-constructor-bodies-jep-513">Flexible Constructor Bodies (JEP 513)</h1><p>For decades, Java developers have lived by a strict rule: <strong><code class="language-plaintext highlighter-rouge">super()</code> or <code class="language-plaintext highlighter-rouge">this()</code> must be the very first statement in a constructor.</strong></p><p>This restriction often led to awkward workarounds when we needed to validate arguments or prepare data <em>before</em> invoking the parent class constructor. Java 25 solves this with <strong>Flexible Constructor Bodies</strong> (JEP 513).</p><h2 id="the-problem">The Problem</h2><p>Suppose you want to valid an argument before passing it to the superclass constructor. In older Java versions, you couldn’t simply do this:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PositiveBigInteger</span> <span class="kd">extends</span> <span class="nc">BigInteger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">PositiveBigInteger</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"non-positive value"</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">value</span><span class="o">));</span> <span class="c1">// ERROR in older Java!</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Because the validation check happens before <code class="language-plaintext highlighter-rouge">super()</code>, this code would fail to compile. We often had to resort to static helper methods:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PositiveBigInteger</span> <span class="kd">extends</span> <span class="nc">BigInteger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">PositiveBigInteger</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">validate</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">validate</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"non-positive value"</span><span class="o">);</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>This works, but it’s verbose and less readable.</p><h2 id="the-java-25-solution">The Java 25 Solution</h2><p>With <strong>Flexible Constructor Bodies</strong>, JDK 25 relaxes this rule. You can now place statements <em>before</em><code class="language-plaintext highlighter-rouge">super()</code> or <code class="language-plaintext highlighter-rouge">this()</code>, as long as they don’t access the instance being created (i.e., you can’t use <code class="language-plaintext highlighter-rouge">this</code> to access fields or methods yet).</p><p>Now, the first example is valid Java code!</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PositiveBigInteger</span> <span class="kd">extends</span> <span class="nc">BigInteger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">PositiveBigInteger</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"non-positive value"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Validating value: "</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">value</span><span class="o">));</span> <span class="c1">// Perfectly legal in Java 25</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><h3 id="key-rules">Key Rules</h3><ol><li><strong>No instance access</strong>: You cannot access <code class="language-plaintext highlighter-rouge">this</code> (fields, instance methods) before the <code class="language-plaintext highlighter-rouge">super()</code> call completes. The object is not initialized yet.</li><li><strong>Assignments allowed</strong>: You can assign to local variables.</li><li><strong>Exception throwing</strong>: You can throw exceptions (fail fast!).</li></ol><h2 id="why-is-this-better">Why is this better?</h2><ul><li><strong>Readability</strong>: Validation logic stays inside the constructor where it belongs.</li><li><strong>Safety</strong>: Failing fast before the super constructor (which might be expensive) prevents unnecessary work.</li><li><strong>Cleanliness</strong>: Eliminates the need for artificial static helper methods just to satisfy compiler rules.</li></ul><p>This small change makes writing robust constructors much more natural and intuitive.</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java25"/><summary type="html"><![CDATA[Flexible Constructor Bodies in Java 25 allow statements before super(), giving you more control over object initialization.]]></summary></entry><entry><title type="html">Compact Source Files (Java 25)</title><link href="https://thoughtstopen.com/java-25-compact-source-files/" rel="alternate" type="text/html" title="Compact Source Files (Java 25)"/><published>2025-09-22T10:00:00-06:00</published><updated>2025-09-22T10:00:00-06:00</updated><id>https://thoughtstopen.com/java-25-compact-source-files</id><content type="html" xml:base="https://thoughtstopen.com/java-25-compact-source-files/"><![CDATA[<h1 id="compact-source-files--instance-main-methods-jep-512">Compact Source Files &amp; Instance Main Methods (JEP 512)</h1><p><strong>NOTE</strong>: This feature, formerly known as <em>Implicitly Declared Classes and Instance Main Methods</em>, is finalized in Java 25.</p><p>One of the biggest hurdles for beginners learning Java has always been the boilerplate code. To write a simple “Hello, World!”, you needed a public class, a static main method, and an array of Strings argument that you probably wouldn’t use.</p><p>Java 25 changes this with <strong>Compact Source Files</strong> (JEP 512). This feature allows you to write Java programs that are more concise and script-like, without sacrificing the power of the language.</p><h2 id="the-old-way">The Old Way</h2><p>Remember this?</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello, World!"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>For a newcomer, this is a lot to digest. What is <code class="language-plaintext highlighter-rouge">public</code>? What is <code class="language-plaintext highlighter-rouge">static</code>? Why <code class="language-plaintext highlighter-rouge">String[] args</code>?</p><h2 id="the-new-way-java-25">The New Way (Java 25)</h2><p>With Java 25, you can simply write:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">main</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello, World!"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><p>That’s it! No class declaration, no <code class="language-plaintext highlighter-rouge">public</code>, no <code class="language-plaintext highlighter-rouge">static</code>, and no <code class="language-plaintext highlighter-rouge">String[] args</code> if you don’t need them.</p><h3 id="how-it-works">How it works</h3><p>Behind the scenes, the Java compiler treats this as if it were inside an <em>implicitly declared class</em>.</p><ul><li><strong>Instance Main Methods</strong>: The <code class="language-plaintext highlighter-rouge">main</code> method no longer needs to be <code class="language-plaintext highlighter-rouge">static</code>. It can be an instance method.</li><li><strong>No Access Modifiers</strong>: You don’t strict need <code class="language-plaintext highlighter-rouge">public</code> or <code class="language-plaintext highlighter-rouge">protected</code>.</li><li><strong>Implicit Class</strong>: If your source file doesn’t have an outer class declaration, the compiler automatically wraps your methods and fields in a class.</li></ul><h2 id="fields-and-methods">Fields and Methods</h2><p>You can also define fields and other methods just like you would in a normal class:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">greeting</span> <span class="o">=</span> <span class="s">"Hello, Java 25!"</span><span class="o">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">greeting</span><span class="o">);</span>
    <span class="n">greetUser</span><span class="o">(</span><span class="s">"Developer"</span><span class="o">);</span>
<span class="o">}</span>

<span class="kt">void</span> <span class="nf">greetUser</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Welcome, "</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><p>This makes Java feel much more like a scripting language for small programs, while still being full-fledged Java.</p><h2 id="why-is-this-important">Why is this important?</h2><ol><li><strong>Beginner Friendly</strong>: Reduces concepts needed to write the first program.</li><li><strong>Less Boilerplate</strong>: clearer code for small utilities and scripts.</li><li><strong>Gradual Complexity</strong>: You can start with a simple method and evolve it into a full class structure as your program grows.</li></ol><p>This feature was previewed in JDK 21 and is now a standard feature in JDK 25!</p>]]></content><author><name></name></author><category term="programming"/><category term="java"/><category term="java25"/><summary type="html"><![CDATA[Java 25 introduces Compact Source Files to reduce boilerplate and make the language more beginner-friendly.]]></summary></entry></feed>